**通常一个页面有三个阶段：加载阶段、交互阶段和关闭阶段**

-   加载阶段，是指从发出请求到渲染出完整页面的过程，影响到这个阶段的主要因素有网络和 JavaScript 脚本。
-   交互阶段，主要是从页面加载完成到用户交互的整合过程，影响到这个阶段的主要因素是 JavaScript 脚本。
-   关闭阶段，主要是用户发出关闭指令后页面所做的一些清理操作


## 加载阶段

我们把这些能阻塞网页首次渲染的资源称为关键资源。基于关键资源，我们可以继续细化出来三个影响页面首次渲染的核心因素。

**第一个是关键资源个数。关键资源个数越多，首次页面的加载时间就会越长**。
**第二个是关键资源大小**。
**第三个是请求关键资源需要多少个 RTT（Round Trip Time）**


## 交互阶段

交互阶段的优化，其实就是在谈渲染进程渲染帧的速度，在交互阶段，帧的渲染速度决定了交互的流畅度。

在交互阶段没有了加载关键资源和构建 DOM、CSSOM 流程，通常是由 JavaScript 触发交互动画的。
![](https://raw.githubusercontent.com/SilverCoin0214/XavierCoinPic/main/image/%08js/202302021443179.png)


在大部分情况下， 生成一个新的帧都是由JS通过修改DOM或者CSSOM来触发的。还有一部分是由CSS触发的。

如果在计算样式阶段有布局信息的修改，就会发生重排操作。
如果在样式计算阶段没有发现布局信息修改，就不会影响到布局和图层的变化，而是进入绘制阶段，这时发生的是重绘。 也就是绘制指令的修改。

另一种情况是， CSS实现一些变形，渐变，动画等效果，这是CSS触发的，在单独的图层上。直接进入合成线程里执行，不会触发重排和重绘。

优化方向：
- **1. 减少 JavaScript 脚本执行时间**
	-  一种是将一次执行的函数分解为多个任务，使得每次的执行时间不要过久。
	- 另一种是采用 Web Workers。
- **2. 避免强制同步布局**
	- 正常JS对DOM操作都是在之后异步操作进行的，但如果在代码同添加了需要对DOM操作后的情况做修改时，就会在一个任务里完成整个渲染工作，导致单任务时间过长。
- **3. 避免布局抖动**
	- 尽量不要在修改 DOM 结构时再去查询一些相关值
- **4. 合理利用 CSS 合成动画**
- **5. 避免频繁的垃圾回收**
	- 垃圾回收会占用主线程的操作，影响其他任务的执行