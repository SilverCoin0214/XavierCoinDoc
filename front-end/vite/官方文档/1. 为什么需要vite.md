### 现实问题：
- 构建工程变大，基于js的开发工具遇到性能瓶颈。
- 缓慢的服务器启动
	-  当冷启动开发服务器时，基于打包器的方式启动必须优先抓取并构建你的整个应用，然后才能提供服务
- 缓慢的更新
	- 基于打包器启动时，重建整个包的效率很低。原因显而易见：因为这样更新速度会随着应用体积增长而直线下降。
	- 即使采用了 HMR 模式，其热更新速度也会随着应用规模的增长而显著下降

### Vite解决：
- 通过将应用模块区分为 依赖 和 源码， 改进服务器启动时间。
	- 依赖通常是不会变的 纯JS， vite会使用 esbuild 预构建依赖。
	- 源码就是项目里的一些文件，不一定都是JS。 可能需要转换也有编辑。
	- Vite 以 原生ESM 方式提供源码。这实际上是让浏览器接管了打包程序的部分工作：Vite 只需要在浏览器请求源码时进行转换并按需提供源码。
	- ![](https://s2.loli.net/2024/03/21/Y5Qy1O9VwuNaKhn.png)
- 在 Vite 中，HMR 是在原生 ESM 上执行的。当编辑一个文件时，Vite 只需要精确地使已编辑的模块与其最近的 HMR 边界之间的链失活
	- Vite 同时利用 HTTP 头来加速整个页面的重新加载：源码模块的请求会根据 `304 Not Modified` 进行协商缓存，而依赖模块请求则会通过 `Cache-Control: max-age=31536000,immutable` 进行强缓存，因此一旦被缓存它们将不需要再次请求。


#### 为什么生产环境需要打包
- 嵌套导入会导致额外的网络往返，在生产环境中发布未打包的 ESM 仍然效率低下。
- 为了在生产环境中获得最佳的加载性能，最好还是将代码进行 tree-shaking、懒加载和 chunk 分割


## vite的组成部分

- 一个开发服务器，基于原生 ES 模块
- 一套构建指令， 使用 Rollup  打包代码， 并且是预配置的。

## `index.html` 与项目根目录
- 一个vite项目中， index.html在项目最外层而不是在public文件夹内。
- 在开发期间 Vite 是一个服务器，而 `index.html` 是该 Vite 项目的入口文件。
- `vite` 以当前工作目录作为根目录启动开发服务器
- 源码中的绝对 URL 路径将以项目的 “根” 作为基础来解析
- 